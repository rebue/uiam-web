"use strict";const e=require("electron"),d=require("path"),s=!e.app.isPackaged;console.log("isDev",s);if(!s){const o=process.platform==="win32"?"win64":process.platform,t=`${process.env.AUTO_UPDATE_SERVER}/update/${o}/${e.app.getVersion()}`;console.log("更新服务器的地址",t),e.autoUpdater.setFeedURL({url:t}),setInterval(()=>{e.autoUpdater.checkForUpdates()},6e4),e.autoUpdater.on("update-downloaded",(a,r,i)=>{const p={type:"info",buttons:["Restart","Later"],title:"Application Update",message:process.platform==="win32"?r:i,detail:"A new version has been downloaded. Restart the application to apply the updates."};e.dialog.showMessageBox(p).then(l=>{l.response===0&&e.autoUpdater.quitAndInstall()})}),e.autoUpdater.on("error",a=>{console.error("There was a problem updating the application"),console.error(a)})}require("electron-squirrel-startup")&&e.app.quit();const n=()=>{const o=new e.BrowserWindow({width:800,height:600,webPreferences:{preload:d.join(__dirname,"preload.js")}});console.log("main_window_vite_dev_server_url","http://localhost:5173"),console.log("main_window_vite_name","main_window"),o.loadURL("http://localhost:5173")};e.app.whenReady().then(()=>{n(),e.app.on("activate",()=>{e.BrowserWindow.getAllWindows().length===0&&n()})});e.app.on("window-all-closed",()=>{process.platform!=="darwin"&&e.app.quit()});
